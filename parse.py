# OED_unpack_tools.py -- Unpack the 'oed.t' blob included in the OED CD-ROM, then spit out JSON
# Copyright (C) 2018 Jakob Barger
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <https://www.gnu.org/licenses/>.

import json
import html

# You may need to tell Pypy3 where pyparsing is
# import sys
# sys.path.append("/usr/lib/python3/dist-packages/")

from pyparsing import *

entity_table = {
    "&nb;":"",
    "<br>":"",
    "&sp;":"",
    "&aacu;":"&aacute;",
    "&Aacu;":"&Aacute;",
    "&aacuced;":"&lsaquo;aacuced&rsaquo;",
    "&aang;":"&aring;",
    "&Aang;":"&Aring;",
    "&aasper;":"&#7937;",
    "&Aasper;":"&#7945;",
    "&aasperacu;":"&#7941;",
    "&Aasperacu;":"&#7949;",
    "&aasperfrown;":"&#7943;",
    "&aaspergrave;":"&#7939;",
    "&aasperisubacu;":"&#8069;",
    "&Abarab;":"&lsaquo;Abarab&rsaquo;",
    "&Abreve;":"&#258;",
    "&abreve;":"&#259;",
    "&aced;":"&lsaquo;aced&rsaquo;",
    "&acirc;":"&acirc;",
    "&Acirc;":"&Acirc;",
    "&adotab;":"&lsaquo;adotab&rsaquo;",
    "&Aeacu;":"&#508;",
    "&aeacu;":"&#509;",
    "&ae;":"&aelig;",
    "&Ae;":"&AElig;",
    "&aebreve;":"&lsaquo;aebreve&rsaquo;",
    "&aecirc;":"&lsaquo;aecirc&rsaquo;",
    "&aedotab;":"&lsaquo;aedotab&rsaquo;",
    "&Aemac;":"&#482;",
    "&aemac;":"&#483;",
    "&aemacbreve;":"&lsaquo;aemacbreve&rsaquo;",
    "&aetilde;":"&lsaquo;aetilde&rsaquo;",
    "&agrave;":"&agrave;",
    "&Agrave;":"&Agrave;",
    "&ahacek;":"&#462;",
    "&ahook;":"&#261;",
    "&ahookmac;":"&lsaquo;ahookmac&rsaquo;",
    "&aisub;":"&#8115;",
    "&aisubacu;":"&#8116;",
    "&aisubfrown;":"&#8119;",
    "&aisubtilde;":"&#8119;",
    "&albrtime;":"&lsaquo;albrtime&rsaquo;",
    "&alenis;":"&#7936;",
    "&Alenis;":"&#7944;",
    "&alenisacu;":"&#7940;",
    "&Alenisacu;":"&#7948;",
    "&alenisfrown;":"&#7942;",
    "&alenisgrave;":"&#7938;",
    "&alenisisub;":"&#8064;",
    "&alenisisubacu;":"&#8068;",
    "&alenisisubfrown;":"&#8070;",
    "&alenismac;":"&lsaquo;alenismac&rsaquo;",
    "&aleph;":"&alefsym;",
    "&alpha;":"&alpha;",
    "&Alpha;":"&Alpha;",
    "&Amac;":"&#256;",
    "&amac;":"&#257;",
    "&amacacu;":"&lsaquo;amacacu&rsaquo;",
    "&amacbreve;":"&lsaquo;amacbreve&rsaquo;",
    "&amacdotab;":"&lsaquo;amacdotab&rsaquo;",
    "&amactilde;":"&lsaquo;amactilde&rsaquo;",
    "&amacundl;":"&lsaquo;amacundl&rsaquo;",
    "&amp;":"&amp;",
    "&angle;":"&ang;",
    "&ankh;":"&#9765;",
    "&aonq;":"&lsaquo;aonq&rsaquo;",
    "&appreq;":"&#8771;",
    "&aquar;":"&#9810;",
    "&arain;":"&#65227;",
    "&arainfull;":"&#65225;",
    "&aralif;":"&#65165;",
    "&arba;":"&#65169;",
    "&arDadfull;":"&#65213;",
    "&ardal;":"&#65193;",
    "&arHa;":"&#65185;",
    "&arha;":"&#65257;",
    "&aries;":"&#9800;",
    "&arnun;":"&#65255;",
    "&arnunfull;":"&#65253;",
    "&arpa;":"&#64344;",
    "&arqoph;":"&#65237;",
    "&arshinfull;":"&#65206;",
    "&arta;":"&#65175;",
    "&arTa;":"&#65217;",
    "&artafull;":"&#65173;",
    "&artha;":"&#65179;",
    "&arwaw;":"&#65261;",
    "&arya;":"&#65265;",
    "&aryafull;":"&#65267;",
    "&arzero;":"&#1632;",
    "&Asg;":"&#7424;",
    "&asg;":"&#7425;",
    "&assert;":"&#8870;",
    "&astm;":"&#8258;",
    "&at;":"@",
    "&atilde;":"&atilde;",
    "&auml;":"&auml;",
    "&Auml;":"&Auml;",
    "&aundl;":"&lsaquo;aundl&rsaquo;",
    "&ayin;":"&#703;",
    "&ayindotab;":"&#65229;",
    "&ayinold;":"&#65227;",
    "&b1;":"=",
    "&b2;":"=",
    "&b3;":"=",
    "&bantuo;":"&lsaquo;bantuo&rsaquo;",
    "&Bantuo;":"&lsaquo;Bantuo&rsaquo;",
    "&bbar;":"&#384;",
    "&bbc1;":"|",
    "&bbc2;":"&#8214;",
    "&bbl1;":"&lsaquo;bbl1&rsaquo;",
    "&bbr1;":"&lsaquo;bbr1&rsaquo;",
    "&bbr2;":"&lsaquo;bbr2&rsaquo;",
    "&bcop1;":"&lsaquo;bcop1&rsaquo;",
    "&bcop2;":"&lsaquo;bcop2&rsaquo;",
    "&benchm;":"&lsaquo;benchm&rsaquo;",
    "&beta;":"&beta;",
    "&Beta;":"&Beta;",
    "&bigobl;":"&lsaquo;bigobl&rsaquo;",
    "&blb;":"&lsaquo;blb&rsaquo;",
    "&blC;":"&#8493;",
    "&blJ;":"&lsaquo;blJ&rsaquo;",
    "&blozenge;":"&#9670;",
    "&blU;":"&lsaquo;blU&rsaquo;",
    "&bly;":"&lsaquo;bly&rsaquo;",
    "&bra;":"&lsaquo;bra&rsaquo;",
    "&bslash;":"\\",
    "&bsquare;":"&#9632;",
    "&btc1;":"&lsaquo;btc1&rsaquo;",
    "&btc2;":"&lsaquo;btc2&rsaquo;",
    "&btl1;":"&lsaquo;btl1&rsaquo;",
    "&btr1;":"&lsaquo;btr1&rsaquo;",
    "&btr2;":"&lsaquo;btr2&rsaquo;",
    "&btril;":"&#9664;",
    "&btrir;":"&#9654;",
    "&bundl;":"&#7687;",
    "&burman;":"&lsaquo;burman&rsaquo;",
    "&cab;":"&rang;",
    "&cacu;":"&#263;",
    "&canc;":"&#9803;",
    "&capr;":"&#9809;",
    "&car;":"&#8634;",
    "&caret;":"&#8248;",
    "&Car;":"&lsaquo;Car&rsaquo;",
    "&cb;":"&#10101;",
    "&cbigb;":"&lsaquo;cbigb&rsaquo;",
    "&cbigpren;":"&lsaquo;cbigpren&rsaquo;",
    "&cbigsb;":"&lsaquo;cbigsb&rsaquo;",
    "&cbreve;":"&lsaquo;cbreve&rsaquo;",
    "&Cbreve;":"&lsaquo;Cbreve&rsaquo;",
    "&cced;":"&ccedil;",
    "&Cced;":"&Ccedil;",
    "&ccirc;":"&#265;",
    "&cdotab;":"&#267;",
    "&cdotbl;":"&lsaquo;cdotbl&rsaquo;",
    "&cdsb;":"&#10215;",
    "&cent;":"&cent;",
    "&Chacek;":"&#268;",
    "&chacek;":"&#269;",
    "&chacekdotab;":"&lsaquo;chacekdotab&rsaquo;",
    "&chi;":"&chi;",
    "&Chi;":"&Chi;",
    "&Chirho;":"&#9767;",
    "&chook;":"&#1195;",
    "&circle;":"&#9675;",
    "&circledot;":"&#9737;",
    "&clenis;":"&lsaquo;clenis&rsaquo;",
    "&click;":"&lsaquo;click&rsaquo;",
    "&cmac;":"&lsaquo;cmac&rsaquo;",
    "&comtime;":"&lsaquo;comtime&rsaquo;",
    "&congr;":"&cong;",
    "&conj;":"&#9740;",
    "&cprt;":"&copy;",
    "&cqq;":"&rdquo;",
    "&cq;":"&rsquo;",
    "&cross;":"&#10016;",
    "&crotchet;":"&#9833;",
    "&csb;":"]",
    "&Csigma;":"&#1017;",
    "&Csub;":"&sube;",
    "&ctilde;":"&lsaquo;ctilde&rsaquo;",
    "&ctlig;":"&lsaquo;ctlig&rsaquo;",
    "&cursived;":"&part;",
    "&cyra;":"&#1072;",
    "&cyrd;":"&#1076;",
    "&cyre;":"&#1077;",
    "&cyrhard;":"&#1098;",
    "&cyrjat;":"&#1123;",
    "&cyrm;":"&#1084;",
    "&cyrn;":"&#1085;",
    "&cyrO;":"&#1054;",
    "&cyrP;":"&#1055;",
    "&cyrr;":"&#1088;",
    "&cyrsoft;":"&#1100;",
    "&cyrt;":"&#1090;",
    "&cyry;":"&#1099;",
    "&dag;":"&dagger;",
    "&dbar;":"&#273;",
    "&dblgt;":"&#8811;",
    "&dbllt;":"&#8810;",
    "&dced;":"&#7697;",
    "&dd;":"&#8229;",
    "&ddag;":"&Dagger;",
    "&ddd;":"&hellip;",
    "&ddotab;":"&#7691;",
    "&Ddotbl;":"&#7692;",
    "&ddotbl;":"&#7693;",
    "&decr;":"&darr;",
    "&deg;":"&deg;",
    "&dele;":"&lsaquo;dele&rsaquo;",
    "&delta;":"&delta;",
    "&Delta;":"&Delta;",
    "&descnode;":"&#9739;",
    "&devdh;":"&#2343;",
    "&devph;":"&#2347;",
    "&devrfls;":"&#2359;",
    "&devrt;":"&#2335;",
    "&devrth;":"&#2336;",
    "&devt;":"&#2340;",
    "&devth;":"&#2341;",
    "&diam;":"&#9826;",
    "&digamma;":"&#989;",
    "&ditto;":"&lsaquo;ditto&rsaquo;",
    "&div;":"&divide;",
    "&dlessi;":"&#305;",
    "&dlessj1;":"&lsaquo;dlessj1&rsaquo;",
    "&dlessj2;":"&lsaquo;dlessj2&rsaquo;",
    "&dlessj3;":"&lsaquo;dlessj3&rsaquo;",
    "&dollar;":"$",
    "&drachm;":"&lsaquo;drachm&rsaquo;",
    "&dtilde;":"&lsaquo;dtilde&rsaquo;",
    "&dubh;":"&#8275;",
    "&dundl;":"&#7695;",
    "&duplong1;":"&lsaquo;duplong1&rsaquo;",
    "&duplong2;":"&lsaquo;duplong2&rsaquo;",
    "&eacudotbl;":"&lsaquo;eacudotbl&rsaquo;",
    "&eacu;":"&eacute;",
    "&Eacu;":"&Eacute;",
    "&earth;":"&oplus;",
    "&easper;":"&#7953;",
    "&Easper;":"&#7961;",
    "&easperacu;":"&#7957;",
    "&Easperacu;":"&#7965;",
    "&easpergrave;":"&#7955;",
    "&ebreve;":"&#277;",
    "&ecirc;":"&ecirc;",
    "&Ecirc;":"&Ecirc;",
    "&edh;":"&eth;",
    "&Edh;":"&ETH;",
    "&edotab;":"&#279;",
    "&edotabacu;":"&lsaquo;edotabacu&rsaquo;",
    "&edotabtilde;":"&lsaquo;edotabtilde&rsaquo;",
    "&Edotbl;":"&#7864;",
    "&edotbl;":"&#7865;",
    "&edotblmac;":"&lsaquo;edotblmac&rsaquo;",
    "&egchi;":"&lsaquo;egchi&rsaquo;",
    "&eggamma1;":"&lsaquo;eggamma1&rsaquo;",
    "&eggamma2;":"&lsaquo;eggamma2&rsaquo;",
    "&egiota;":"&lsaquo;egiota&rsaquo;",
    "&egkappa;":"&lsaquo;egkappa&rsaquo;",
    "&eglambda;":"&lsaquo;eglambda&rsaquo;",
    "&egmu1;":"&lsaquo;egmu1&rsaquo;",
    "&egmu2;":"&lsaquo;egmu2&rsaquo;",
    "&egnu1;":"&lsaquo;egnu1&rsaquo;",
    "&egnu2;":"&lsaquo;egnu2&rsaquo;",
    "&egpi1;":"&lsaquo;egpi1&rsaquo;",
    "&egpi2;":"&lsaquo;egpi2&rsaquo;",
    "&egpi3;":"&lsaquo;egpi3&rsaquo;",
    "&egrave;":"&egrave;",
    "&egrho1;":"&lsaquo;egrho1&rsaquo;",
    "&egrho2;":"&lsaquo;egrho2&rsaquo;",
    "&egsampi;":"&lsaquo;egsampi&rsaquo;",
    "&egsan;":"&lsaquo;egsan&rsaquo;",
    "&egsigma1;":"&lsaquo;egsigma1&rsaquo;",
    "&egsigma2;":"&lsaquo;egsigma2&rsaquo;",
    "&egxi1;":"&lsaquo;egxi1&rsaquo;",
    "&egxi2;":"&lsaquo;egxi2&rsaquo;",
    "&egxi3;":"&lsaquo;egxi3&rsaquo;",
    "&egy3;":"&lsaquo;egy3&rsaquo;",
    "&egyasper;":"&lsaquo;egyasper&rsaquo;",
    "&ehacek;":"&#283;",
    "&Ehook;":"&#280;",
    "&ehook;":"&#281;",
    "&ehookacu;":"&lsaquo;ehookacu&rsaquo;",
    "&ehookmacbreve;":"&lsaquo;ehookmacbreve&rsaquo;",
    "&ehookmac;":"&lsaquo;ehookmac&rsaquo;",
    "&elatc1;":"&lsaquo;elatc1&rsaquo;",
    "&elatc2;":"&lsaquo;elatc2&rsaquo;",
    "&elatg1;":"&lsaquo;elatg1&rsaquo;",
    "&elatg2;":"&lsaquo;elatg2&rsaquo;",
    "&elatS;":"&lsaquo;elatS&rsaquo;",
    "&elem;":"&isin;",
    "&elenis;":"&#7952;",
    "&Elenis;":"&#7960;",
    "&elenisacu;":"&#7956;",
    "&Elenisacu;":"&#7964;",
    "&Elenisfrown;":"&lsaquo;Elenisfrown&rsaquo;",
    "&elenisgrave;":"&#7954;",
    "&Emac;":"&#274;",
    "&emac;":"&#275;",
    "&emacacu;":"&#7703;",
    "&emacbreve;":"&lsaquo;emacbreve&rsaquo;",
    "&emachacek;":"&lsaquo;emachacek&rsaquo;",
    "&emem;":"&#8213;",
    "&em;":"&mdash;",
    "&en;":"&ndash;",
    "&epsiloncirc;":"&lsaquo;epsiloncirc&rsaquo;",
    "&epsilon;":"&epsilon;",
    "&Epsilon;":"&Epsilon;",
    "&equil;":"&#8652;",
    "&ergo;":"&there4;",
    "&eszett;":"&szlig;",
    "&eta;":"&eta;",
    "&Eta;":"&Eta;",
    "&etaisub;":"&#8131;",
    "&etilde;":"&#7869;",
    "&eumlacu;":"&lsaquo;eumlacu&rsaquo;",
    "&euml;":"&euml;",
    "&eundlacu;":"&lsaquo;eundlacu&rsaquo;",
    "&eundl;":"&lsaquo;eundl&rsaquo;",
    "&euro;":"&euro;",
    "&expon;":"&uarr;",
    "&fac;":"&lsaquo;fac&rsaquo;",
    "&fact;":"&lsaquo;fact&rsaquo;",
    "&fata;":"&#593;",
    "&fatatilde;":"&lsaquo;fatatilde&rsaquo;",
    "&fatpara;":"&lsaquo;fatpara&rsaquo;",
    "&female;":"&#9792;",
    "&ffilig;":"&#64259;",
    "&ffllig;":"&#64260;",
    "&flat;":"&#9837;",
    "&fllig;":"&#64258;",
    "&fourd;":"&lsaquo;fourd&rsaquo;",
    "&frakB;":"&lsaquo;frakB&rsaquo;",
    "&frakE;":"&lsaquo;frakE&rsaquo;",
    "&frakF;":"&lsaquo;frakF&rsaquo;",
    "&frakg;":"&lsaquo;frakg&rsaquo;",
    "&frakG;":"&lsaquo;frakG&rsaquo;",
    "&frakH;":"&#8460;",
    "&frakh;":"&lsaquo;frakh&rsaquo;",
    "&frakI;":"&image;",
    "&frakK;":"&lsaquo;frakK&rsaquo;",
    "&frakL;":"&lsaquo;frakL&rsaquo;",
    "&frakM;":"&lsaquo;frakM&rsaquo;",
    "&frakP;":"&lsaquo;frakP&rsaquo;",
    "&frakR;":"&real;",
    "&frakU;":"&lsaquo;frakU&rsaquo;",
    "&frakX;":"&lsaquo;frakX&rsaquo;",
    "&frakY;":"&lsaquo;frakY&rsaquo;",
    "&fsigma;":"&sigmaf;",
    "&fslash;":"/",
    "&gaacu;":"&#8049;",
    "&gabreve;":"&#8112;",
    "&gacu;":"&#501;",
    "&gafrown;":"&#8118;",
    "&gagrave;":"&#8048;",
    "&gamac;":"&#8113;",
    "&gamacacu;":"&lsaquo;gamacacu&rsaquo;",
    "&gamacbreve;":"&lsaquo;gamacbreve&rsaquo;",
    "&gamma;":"&gamma;",
    "&Gamma;":"&Gamma;",
    "&gaumlisub;":"&lsaquo;gaumlisub&rsaquo;",
    "&Gbreve;":"&#286;",
    "&gbreve;":"&#287;",
    "&gcirc;":"&#285;",
    "&gdotab;":"&#289;",
    "&ge;":"&#8807;",
    "&geacu;":"&#941;",
    "&gegrave;":"&#8050;",
    "&ghacek;":"&#487;",
    "&ghacu;":"&#8053;",
    "&ghfrown;":"&#8134;",
    "&ghgrave;":"&#8052;",
    "&ghmac;":"&lsaquo;ghmac&rsaquo;",
    "&giacu;":"&#943;",
    "&gibreve;":"&#8144;",
    "&gibreveacu;":"&lsaquo;gibreveacu&rsaquo;",
    "&gifrown;":"&#8150;",
    "&gigrave;":"&#8054;",
    "&gimac;":"&#8145;",
    "&gimacacu;":"&lsaquo;gimacacu&rsaquo;",
    "&giuml;":"&#970;",
    "&giumlacu;":"&#8147;",
    "&giumlgrave;":"&#8146;",
    "&glagjat;":"&lsaquo;glagjat&rsaquo;",
    "&glagjeri;":"&lsaquo;glagjeri&rsaquo;",
    "&glagjeru;":"&lsaquo;glagjeru&rsaquo;",
    "&glots;":"&#660;",
    "&gmac;":"&#7713;",
    "&goacu;":"&#972;",
    "&gobreve;":"&lsaquo;gobreve&rsaquo;",
    "&gograve;":"&#8056;",
    "&gt;":"&rsaquo;",
    "&guacu;":"&#973;",
    "&gubreve;":"&#8160;",
    "&gufrown;":"&#8166;",
    "&gugrave;":"&#8058;",
    "&gumac;":"&#8161;",
    "&gumacacu;":"&lsaquo;gumacacu&rsaquo;",
    "&gundl;":"&lsaquo;gundl&rsaquo;",
    "&Gundl;":"&lsaquo;Gundl&rsaquo;",
    "&guuml;":"&#971;",
    "&guumlacu;":"&#8163;",
    "&gwacu;":"&#8061;",
    "&gwfrown;":"&#8182;",
    "&gwgrave;":"&#8060;",
    "&half;":"&frac12;",
    "&halft;":"&lsaquo;halft&rsaquo;",
    "&hamza;":"&#65152;",
    "&hash;":"#",
    "&hasper;":"&#7969;",
    "&Hasper;":"&#7977;",
    "&hasperacu;":"&#7973;",
    "&Hasperacu;":"&#7981;",
    "&hasperfrown;":"&#7975;",
    "&hasperisubfrown;":"&#8087;",
    "&hatpath;":"&#1458;",
    "&hatqam;":"&#1459;",
    "&hatseg;":"&#1457;",
    "&hbar;":"&#295;",
    "&Hbrbl;":"&#7722;",
    "&hbrbl;":"&#7723;",
    "&hdotab;":"&#7715;",
    "&Hdotbl;":"&#7716;",
    "&hdotbl;":"&#7717;",
    "&heart;":"&hearts;",
    "&hebaleph;":"&#1488;",
    "&hebayin;":"&#1506;",
    "&hebbeth;":"&#1489;",
    "&hebcheth;":"&#1495;",
    "&hebdaleth;":"&#1491;",
    "&hebgimel;":"&#1490;",
    "&hebhe;":"&#1492;",
    "&hebkaph;":"&#1499;",
    "&heblamed;":"&#1500;",
    "&hebmem;":"&#1502;",
    "&hebnun;":"&#1504;",
    "&hebnunfin;":"&#1503;",
    "&hebpe;":"&#1508;",
    "&hebpedag;":"&#64324;",
    "&hebqoph;":"&#1511;",
    "&hebresh;":"&#1512;",
    "&hebshin;":"&#1513;",
    "&hebtav;":"&#1514;",
    "&hebteth;":"&#1496;",
    "&hebtsade;":"&#1510;",
    "&hebwaw;":"&#1493;",
    "&hebyod;":"&#1497;",
    "&hebzayin;":"&#1494;",
    "&hgz;":"&#549;",
    "&hireq;":"&#1460;",
    "&hisub;":"&#8131;",
    "&hisubacu;":"&#8132;",
    "&hisubfrown;":"&#8135;",
    "&hlenis;":"&#7968;",
    "&Hlenis;":"&#7976;",
    "&hlenisacu;":"&#7972;",
    "&hlenisfrown;":"&#7974;",
    "&hlenisgrave;":"&#7970;",
    "&horizb;":"&lsaquo;horizb&rsaquo;",
    "&horizE;":"&lsaquo;horizE&rsaquo;",
    "&horizP;":"&lsaquo;horizP&rsaquo;",
    "&horizS;":"&lsaquo;horizS&rsaquo;",
    "&horizT;":"&lsaquo;horizT&rsaquo;",
    "&huncU;":"&lsaquo;huncU&rsaquo;",
    "&hundl;":"&#7830;",
    "&hypolem;":"&lsaquo;hypolem&rsaquo;",
    "&iacu;":"&iacute;",
    "&Iacu;":"&Iacute;",
    "&iasper;":"&#7985;",
    "&Iasper;":"&#7993;",
    "&iasperacu;":"&#7989;",
    "&Iasperacu;":"&#7997;",
    "&iasperfrown;":"&#7991;",
    "&ibar;":"&#616;",
    "&Ibreve;":"&#300;",
    "&ibreve;":"&#301;",
    "&ibrevemac;":"&lsaquo;ibrevemac&rsaquo;",
    "&iced;":"&lsaquo;iced&rsaquo;",
    "&icirc;":"&icirc;",
    "&Icirc;":"&Icirc;",
    "&ident;":"&equiv;",
    "&ifflig;":"&#64256;",
    "&ifilig;":"&#64257;",
    "&ifrbl;":"&lsaquo;ifrbl&rsaquo;",
    "&igrave;":"&igrave;",
    "&ihacek;":"&#464;",
    "&ilenis;":"&#7984;",
    "&Ilenis;":"&#7992;",
    "&ilenisacu;":"&#7988;",
    "&Ilenisacu;":"&#7996;",
    "&ilenisfrown;":"&#7990;",
    "&ilenismacacu;":"&lsaquo;ilenismacacu&rsaquo;",
    "&ilenismac;":"&lsaquo;ilenismac&rsaquo;",
    "&Imac;":"&#298;",
    "&imac;":"&#299;",
    "&imacacu;":"&lsaquo;imacacu&rsaquo;",
    "&imacbreve;":"&lsaquo;imacbreve&rsaquo;",
    "&imachacek;":"&lsaquo;imachacek&rsaquo;",
    "&imacuml;":"&lsaquo;imacuml&rsaquo;",
    "&imacundl;":"&lsaquo;imacundl&rsaquo;",
    "&implies;":"&rArr;",
    "&index;":"&#9755;",
    "&infin;":"&infin;",
    "&integ;":"&int;",
    "&Integ;":"&int;",
    "&intsec;":"&cap;",
    "&intset;":"&#8484;",
    "&invpri;":"&#719;",
    "&iota;":"&iota;",
    "&Iota;":"&Iota;",
    "&istlig;":"&#64262;",
    "&italU;":"&lsaquo;italU&rsaquo;",
    "&itilde;":"&#297;",
    "&iuml;":"&iuml;",
    "&iundl;":"&lsaquo;iundl&rsaquo;",
    "&jbreve;":"&lsaquo;jbreve&rsaquo;",
    "&jhacek;":"&#496;",
    "&jundl;":"&lsaquo;jundl&rsaquo;",
    "&jup;":"&#9795;",
    "&kappa;":"&kappa;",
    "&Kappa;":"&Kappa;",
    "&Kdotbl;":"&#7730;",
    "&kdotbl;":"&#7731;",
    "&Koppa;":"&#990;",
    "&koppa;":"&#991;",
    "&Kundl;":"&#7732;",
    "&kundl;":"&#7733;",
    "&lambda;":"&lambda;",
    "&Lambda;":"&Lambda;",
    "&lar;":"&larr;",
    "&Lbar;":"&#321;",
    "&lbar;":"&#322;",
    "&lbelt;":"&lsaquo;lbelt&rsaquo;",
    "&lcircbl;":"&lsaquo;lcircbl&rsaquo;",
    "&ldotbl;":"&#7735;",
    "&le;":"&#8806;",
    "&leo;":"&#9804;",
    "&lhalfbr;":"&lceil;",
    "&lhshoe;":"&sup;",
    "&libra;":"&#9806;",
    "&llswing;":"&lsaquo;llswing&rsaquo;",
    "&lm;":"&#720;",
    "&logicand;":"&and;",
    "&logicor;":"&or;",
    "&longmord;":"&lsaquo;longmord&rsaquo;",
    "&longs;":"&#383;",
    "&lrar;":"&harr;",
    "&ltappr;":"&#8818;",
    "&ltflat;":"&ang;",
    "&ltilde;":"&#619;",
    "&lt;":"&lsaquo;",
    "&ltlt;":"&#8810;",
    "&lumlbl;":"&lsaquo;lumlbl&rsaquo;",
    "&male;":"&#9794;",
    "&mbwvow;":"&lsaquo;mbwvow&rsaquo;",
    "&mcircbl;":"&lsaquo;mcircbl&rsaquo;",
    "&mdotab;":"&#7745;",
    "&mdotbl;":"&#7747;",
    "&mdotblacu;":"&lsaquo;mdotblacu&rsaquo;",
    "&merc;":"&#9791;",
    "&mfrown;":"&lsaquo;mfrown&rsaquo;",
    "&min;":"&minus;",
    "&minpl;":"&#8723;",
    "&moonfq;":"&#9789;",
    "&moonlq;":"&#9790;",
    "&mord;":"&lsaquo;mord&rsaquo;",
    "&mostra;":"&lsaquo;mostra&rsaquo;",
    "&msyllab;":"&lsaquo;msyllab&rsaquo;",
    "&mtilde;":"&lsaquo;mtilde&rsaquo;",
    "&mu;":"&micro;",
    "&Mu;":"&Mu;",
    "&mundl;":"&lsaquo;mundl&rsaquo;",
    "&nacu;":"&#324;",
    "&Naira;":"&#8358;",
    "&natural;":"&#9838;",
    "&nbreve;":"&lsaquo;nbreve&rsaquo;",
    "&ncircbl;":"&lsaquo;ncircbl&rsaquo;",
    "&ncirc;":"&lsaquo;ncirc&rsaquo;",
    "&Ndotab;":"&#7748;",
    "&ndotab;":"&#7749;",
    "&ndotbl;":"&#7751;",
    "&neq;":"&ne;",
    "&nfacu;":"&acute;",
    "&nfasper;":"&#8190;",
    "&nfbreve;":"&#728;",
    "&nfced;":"&cedil;",
    "&nfcirc;":"&circ;",
    "&nffrown;":"&lsaquo;nffrown&rsaquo;",
    "&nfgra;":"&#715;",
    "&nfhacek;":"&#711;",
    "&nfmac;":"&#713;",
    "&nftilde;":"&tilde;",
    "&nfuml;":"&uml;",
    "&nfundl;":"&lsaquo;nfundl&rsaquo;",
    "&ng;":"&#331;",
    "&nhacek;":"&#328;",
    "&nmac;":"&lsaquo;nmac&rsaquo;",
    "&nono;":"&lsaquo;nono&rsaquo;",
    "&notelem;":"&notin;",
    "&not;":"&not;",
    "&nowy;":"&lsaquo;nowy&rsaquo;",
    "&ntilde;":"&ntilde;",
    "&nundl;":"&#7753;",
    "&nu;":"&nu;",
    "&Nu;":"&Nu;",
    "&oab;":"&lang;",
    "&oacu;":"&oacute;",
    "&Oacu;":"&Oacute;",
    "&oasper;":"&#8001;",
    "&Oasper;":"&#8009;",
    "&oasperacu;":"&#8005;",
    "&Oasperacu;":"&#8013;",
    "&oaspergrave;":"&#8003;",
    "&ob;":"&#10100;",
    "&obaracu;":"&#511;",
    "&obarmac;":"&lsaquo;obarmac&rsaquo;",
    "&obar;":"&oslash;",
    "&Obar;":"&Oslash;",
    "&obigb;":"&lsaquo;obigb&rsaquo;",
    "&obigpren;":"&lsaquo;obigpren&rsaquo;",
    "&obigsb;":"&lsaquo;obigsb&rsaquo;",
    "&Obreve;":"&#334;",
    "&obreve;":"&#335;",
    "&obrevemac;":"&lsaquo;obrevemac&rsaquo;",
    "&ocircgrave;":"&lsaquo;ocircgrave&rsaquo;",
    "&ocirc;":"&ocirc;",
    "&Ocirc;":"&Ocirc;",
    "&odotab;":"&#559;",
    "&odotblmac;":"&lsaquo;odotblmac&rsaquo;",
    "&odsb;":"&#10214;",
    "&oeacu;":"&lsaquo;oeacu&rsaquo;",
    "&oeamp;":"&lsaquo;oeamp&rsaquo;",
    "&oemacbreve;":"&lsaquo;oemacbreve&rsaquo;",
    "&oemac;":"&lsaquo;oemac&rsaquo;",
    "&oe;":"&oelig;",
    "&Oe;":"&OElig;",
    "&oetilde;":"&lsaquo;oetilde&rsaquo;",
    "&ofrown;":"&#527;",
    "&ograve;":"&ograve;",
    "&ohacek;":"&#466;",
    "&ohgcirc;":"&lsaquo;ohgcirc&rsaquo;",
    "&ohook;":"&#491;",
    "&ohookacu;":"&lsaquo;ohookacu&rsaquo;",
    "&ohookbreve;":"&lsaquo;ohookbreve&rsaquo;",
    "&ohookmac;":"&#493;",
    "&oldbeta;":"&lsaquo;oldbeta&rsaquo;",
    "&oldsemibr1;":"&lsaquo;oldsemibr1&rsaquo;",
    "&oldsemibr2;":"&lsaquo;oldsemibr2&rsaquo;",
    "&olenis;":"&#8000;",
    "&Olenis;":"&#8008;",
    "&olenisacu;":"&#8004;",
    "&Olenisacu;":"&#8012;",
    "&olenisfrown;":"&lsaquo;olenisfrown&rsaquo;",
    "&olenisgrave;":"&#8002;",
    "&Omac;":"&#332;",
    "&omac;":"&#333;",
    "&omacacu;":"&#7763;",
    "&omacbreve;":"&lsaquo;omacbreve&rsaquo;",
    "&omactilde;":"&lsaquo;omactilde&rsaquo;",
    "&omega;":"&omega;",
    "&Omega;":"&Omega;",
    "&omicron;":"&omicron;",
    "&Omicron;":"&Omicron;",
    "&oneon3;":"&#8531;",
    "&oneon4;":"&frac14;",
    "&ope;":"&#603;",
    "&opemac;":"&lsaquo;opemac&rsaquo;",
    "&opetilde;":"&lsaquo;opetilde&rsaquo;",
    "&opp;":"&#9741;",
    "&oq;":"&lsquo;",
    "&oqq;":"&ldquo;",
    "&ormg;":"&lsaquo;ormg&rsaquo;",
    "&osb;":"[",
    "&otilde;":"&otilde;",
    "&oumlmac;":"&#470;",
    "&ouml;":"&ouml;",
    "&Ouml;":"&Ouml;",
    "&ounce;":"&#8485;",
    "&oundl;":"&lsaquo;oundl&rsaquo;",
    "&ovparen;":"&#8256;",
    "&page;":"&#8267;",
    "&pall;":"&#654;",
    "&paln;":"&#626;",
    "&pa;":"&part;",
    "&para2;":"&lsaquo;para2&rsaquo;",
    "&para3;":"&lsaquo;para3&rsaquo;",
    "&para4;":"&lsaquo;para4&rsaquo;",
    "&para5;":"&lsaquo;para5&rsaquo;",
    "&para;":"&para;",
    "&pauseo;":"&lsaquo;pauseo&rsaquo;",
    "&pauseu;":"&lsaquo;pauseu&rsaquo;",
    "&pbar;":"&lsaquo;pbar&rsaquo;",
    "&pcnt;":"%",
    "&pdotab;":"&#7767;",
    "&per;":"&weierp;",
    "&pharyng;":"&#661;",
    "&phi2;":"&phi;",
    "&phi;":"&#981;",
    "&Phi;":"&Phi;",
    "&pi;":"&pi;",
    "&Pi;":"&Pi;",
    "&pisces;":"&#9811;",
    "&planck;":"&#8463;",
    "&plantinJ;":"&lsaquo;plantinJ&rsaquo;",
    "&pmac;":"&lsaquo;pmac&rsaquo;",
    "&pmil;":"&permil;",
    "&pm;":"&plusmn;",
    "&ppp;":"&#8244;",
    "&pp;":"&Prime;",
    "&p;":"&prime;",
    "&prop;":"&prop;",
    "&psense;":"&#9656;",
    "&psi;":"&psi;",
    "&Psi;":"&Psi;",
    "&pstlg;":"&pound;",
    "&ptilde;":"&lsaquo;ptilde&rsaquo;",
    "&pundl;":"&lsaquo;pundl&rsaquo;",
    "&qamets;":"&#1464;",
    "&qdotab;":"&lsaquo;qdotab&rsaquo;",
    "&qhacek;":"&lsaquo;qhacek&rsaquo;",
    "&qtilde;":"&lsaquo;qtilde&rsaquo;",
    "&quaver;":"&#9834;",
    "&racu;":"&#341;",
    "&ragr;":"&lsaquo;ragr&rsaquo;",
    "&rar;":"&rarr;",
    "&rasper;":"&#8165;",
    "&Rasper;":"&#8172;",
    "&rbreve;":"&lsaquo;rbreve&rsaquo;",
    "&rcircbl;":"&lsaquo;rcircbl&rsaquo;",
    "&rcircblmac;":"&lsaquo;rcircblmac&rsaquo;",
    "&Rdotab;":"&#7768;",
    "&rdotab;":"&#7769;",
    "&Rdotbl;":"&#7770;",
    "&rdotbl;":"&#7771;",
    "&rdotblacu;":"&lsaquo;rdotblacu&rsaquo;",
    "&rdotblmac;":"&#7773;",
    "&rdot;":"&middot;",
    "&real;":"&#8477;",
    "&recipe;":"&#8478;",
    "&reg;":"&reg;",
    "&repetn;":"&lsaquo;repetn&rsaquo;",
    "&reva;":"&#594;",
    "&revc;":"&#596;",
    "&revC;":"&#8579;",
    "&revctilde;":"&lsaquo;revctilde&rsaquo;",
    "&revope;":"&#604;",
    "&revopehook;":"&#605;",
    "&revr;":"&#633;",
    "&revrmac;":"&lsaquo;revrmac&rsaquo;",
    "&revsc;":"&lsaquo;revsc&rsaquo;",
    "&revv;":"&#652;",
    "&revvmac;":"&lsaquo;revvmac&rsaquo;",
    "&revvtilde;":"&lsaquo;revvtilde&rsaquo;",
    "&rfa;":"&#594;",
    "&rfatilde;":"&lsaquo;rfatilde&rsaquo;",
    "&rglots;":"&#661;",
    "&rhacek;":"&#345;",
    "&rhalfbr;":"&rceil;",
    "&rho;":"&rho;",
    "&Rho;":"&Rho;",
    "&rhshoe;":"&sub;",
    "&rlenis;":"&#8164;",
    "&roasper;":"&lsaquo;roasper&rsaquo;",
    "&rsyllab;":"&lsaquo;rsyllab&rsaquo;",
    "&rtilde;":"&lsaquo;rtilde&rsaquo;",
    "&ruasper;":"&lsaquo;ruasper&rsaquo;",
    "&runash;":"&lsaquo;runash&rsaquo;",
    "&rundl;":"&#7775;",
    "&runwyn;":"&lsaquo;runwyn&rsaquo;",
    "&rvow;":"&#724;",
    "&Sacu;":"&#346;",
    "&sacu;":"&#347;",
    "&sagit;":"&#9808;",
    "&sampi;":"&#993;",
    "&saturn;":"&#9796;",
    "&sbreve;":"&lsaquo;sbreve&rsaquo;",
    "&Sbreve;":"&lsaquo;Sbreve&rsaquo;",
    "&Sced;":"&#350;",
    "&sced;":"&#351;",
    "&schwa;":"&#601;",
    "&schwaacu;":"&lsaquo;schwaacu&rsaquo;",
    "&schwafrbl;":"&lsaquo;schwafrbl&rsaquo;",
    "&schwamac;":"&lsaquo;schwamac&rsaquo;",
    "&schwatilde;":"&lsaquo;schwatilde&rsaquo;",
    "&scirc;":"&#349;",
    "&scorpio;":"&#9807;",
    "&scrA;":"&lsaquo;scrA&rsaquo;",
    "&scrb;":"&lsaquo;scrb&rsaquo;",
    "&scrC;":"&lsaquo;scrC&rsaquo;",
    "&scrD;":"&lsaquo;scrD&rsaquo;",
    "&scrE;":"&#8496;",
    "&scrF;":"&#8497;",
    "&scrh;":"&lsaquo;scrh&rsaquo;",
    "&scrI;":"&#8464;",
    "&scrJ;":"&lsaquo;scrJ&rsaquo;",
    "&scrL;":"&#8466;",
    "&scrl;":"&#8467;",
    "&scrM;":"&#8499;",
    "&scrQ;":"&lsaquo;scrQ&rsaquo;",
    "&scrR;":"&#8475;",
    "&scrS;":"&lsaquo;scrS&rsaquo;",
    "&scrT;":"&lsaquo;scrT&rsaquo;",
    "&scrU;":"&lsaquo;scrU&rsaquo;",
    "&scruple;":"&#8456;",
    "&Sdotab;":"&#7776;",
    "&sdotab;":"&#7777;",
    "&Sdotbl;":"&#7778;",
    "&sdotbl;":"&#7779;",
    "&sect;":"&sect;",
    "&segno;":"&lsaquo;segno&rsaquo;",
    "&segol;":"&#1462;",
    "&semain1;":"&lsaquo;semain1&rsaquo;",
    "&semain2;":"&lsaquo;semain2&rsaquo;",
    "&semE;":"&exist;",
    "&semhe;":"&lsaquo;semhe&rsaquo;",
    "&semheth;":"&lsaquo;semheth&rsaquo;",
    "&semibr;":"&lsaquo;semibr&rsaquo;",
    "&semkaph;":"&lsaquo;semkaph&rsaquo;",
    "&semlamed1;":"&lsaquo;semlamed1&rsaquo;",
    "&semlamed2;":"&lsaquo;semlamed2&rsaquo;",
    "&semmem;":"&lsaquo;semmem&rsaquo;",
    "&semnun;":"&lsaquo;semnun&rsaquo;",
    "&sempe;":"&lsaquo;sempe&rsaquo;",
    "&semqoph1;":"&lsaquo;semqoph1&rsaquo;",
    "&semqoph2;":"&lsaquo;semqoph2&rsaquo;",
    "&semqoph3;":"&lsaquo;semqoph3&rsaquo;",
    "&semresh;":"&lsaquo;semresh&rsaquo;",
    "&semtav1;":"&lsaquo;semtav1&rsaquo;",
    "&semtav2;":"&lsaquo;semtav2&rsaquo;",
    "&semtav3;":"&lsaquo;semtav3&rsaquo;",
    "&semtav4;":"&lsaquo;semtav4&rsaquo;",
    "&semyod;":"&lsaquo;semyod&rsaquo;",
    "&semzayin1;":"&lsaquo;semzayin1&rsaquo;",
    "&semzayin2;":"&lsaquo;semzayin2&rsaquo;",
    "&semzayin3;":"&lsaquo;semzayin3&rsaquo;",
    "&sgrave;":"&lsaquo;sgrave&rsaquo;",
    "&sh;":"&#643;",
    "&shacekdotab;":"&#7783;",
    "&shacekdotbl;":"&lsaquo;shacekdotbl&rsaquo;",
    "&shacek;":"&scaron;",
    "&Shacek;":"&Scaron;",
    "&shadda;":"&#65148;",
    "&sharp;":"&#9839;",
    "&sheva;":"&#1456;",
    "&shook;":"&#642;",
    "&Shook;":"&lsaquo;Shook&rsaquo;",
    "&shti;":"&#618;",
    "&shtibar;":"&#618;",
    "&shtlong1;":"&lsaquo;shtlong1&rsaquo;",
    "&shtlong2;":"&lsaquo;shtlong2&rsaquo;",
    "&shtsyll;":"&lsaquo;shtsyll&rsaquo;",
    "&shtsyllmac;":"&lsaquo;shtsyllmac&rsaquo;",
    "&shtu;":"&#650;",
    "&sidetri;":"&#9665;",
    "&sigma;":"&sigma;",
    "&Sigma;":"&Sigma;",
    "&sigmatau;":"&#987;",
    "&since;":"&#8757;",
    "&sixon2;":"&lsaquo;sixon2&rsaquo;",
    "&sixon4;":"&lsaquo;sixon4&rsaquo;",
    "&sixon8;":"&lsaquo;sixon8&rsaquo;",
    "&slge;":"&ge;",
    "&slle;":"&le;",
    "&sm;":"&#712;",
    "&Smac;":"&lsaquo;Smac&rsaquo;",
    "&smm;":"&#716;",
    "&smR;":"&#640;",
    "&smY;":"&#655;",
    "&spade;":"&spades;",
    "&sqbreve;":"&lsaquo;sqbreve&rsaquo;",
    "&sqquav;":"&lsaquo;sqquav&rsaquo;",
    "&sqrt;":"&radic;",
    "&square;":"&#9633;",
    "&squaver;":"&lsaquo;squaver&rsaquo;",
    "&star;":"&#10038;",
    "&stilde;":"&lsaquo;stilde&rsaquo;",
    "&stlig;":"&#64261;",
    "&Summ;":"&sum;",
    "&sun;":"&#9737;",
    "&sundl;":"&lsaquo;sundl&rsaquo;",
    "&Sundl;":"&lsaquo;Sundl&rsaquo;",
    "&sup2;":"&sup2;",
    "&supa;":"<sup>a</sup>",
    "&supc;":"<sup>c</sup>",
    "&supd;":"<sup>d</sup>",
    "&supe;":"<sup>e</sup>",
    "&supg;":"<sup>g</sup>",
    "&supgt;":"<sup>&#707;</sup>",
    "&suph;":"<sup>h</sup>",
    "&supi;":"<sup>i</sup>",
    "&supl;":"<sup>l</sup>",
    "&suplt;":"<sup>&#706;</sup>",
    "&supm;":"<sup>m</sup>",
    "&supr;":"<sup>r</sup>",
    "&sups;":"<sup>s</sup>",
    "&supt;":"<sup>t</sup>",
    "&supu;":"<sup>u</sup>",
    "&supw;":"<sup>w</sup>",
    "&supy;":"<sup>y</sup>",
    "&supz;":"<sup>z</sup>",
    "&swast;":"&lsaquo;swast&rsaquo;",
    "&swing;":"&sim;",
    "&tacu;":"&lsaquo;tacu&rsaquo;",
    "&taur;":"&#9801;",
    "&tau;":"&tau;",
    "&Tau;":"&Tau;",
    "&Tbarab;":"&lsaquo;Tbarab&rsaquo;",
    "&tced;":"&#355;",
    "&tdotab;":"&#7787;",
    "&Tdotbl;":"&#7788;",
    "&tdotbl;":"&#7789;",
    "&thbar;":"&lsaquo;thbar&rsaquo;",
    "&Thbar;":"&lsaquo;Thbar&rsaquo;",
    "&thdotab;":"&lsaquo;thdotab&rsaquo;",
    "&theta;":"&theta;",
    "&Theta;":"&Theta;",
    "&thinqm;":"&lsaquo;thinqm&rsaquo;",
    "&threeon16;":"&lsaquo;threeon16&rsaquo;",
    "&threeon2;":"&lsaquo;threeon2&rsaquo;",
    "&threeon4;":"&lsaquo;threeon4&rsaquo;",
    "&threeon8;":"&lsaquo;threeon8&rsaquo;",
    "&th;":"&thorn;",
    "&Th;":"&THORN;",
    "&tie;":"&lsaquo;tie&rsaquo;",
    "&times;":"&times;",
    "&tittle;":"&#8944;",
    "&tri;":"&#8710;",
    "&trli;":"&#8214;",
    "&ts;":"&#8198;",
    "&Tse;":"&#1062;",
    "&ttilde;":"&lsaquo;ttilde&rsaquo;",
    "&Tundl;":"&#7790;",
    "&tundl;":"&#7791;",
    "&two2n;":"&lsaquo;two2n&rsaquo;",
    "&twoon4;":"&lsaquo;twoon4&rsaquo;",
    "&twothird;":"&#8532;",
    "&uacu;":"&uacute;",
    "&Uacu;":"&Uacute;",
    "&uang;":"&#367;",
    "&uangtilde;":"&lsaquo;uangtilde&rsaquo;",
    "&uasper;":"&#8017;",
    "&Uasper;":"&#8025;",
    "&uasperacu;":"&#8021;",
    "&Uasperacu;":"&#8029;",
    "&uasperfrown;":"&#8023;",
    "&ubar;":"&#649;",
    "&Ubox;":"&lsaquo;Ubox&rsaquo;",
    "&ubreve;":"&#365;",
    "&ucirc;":"&ucirc;",
    "&Ucirc;":"&Ucirc;",
    "&uda;":"&#592;",
    "&udA;":"&forall;",
    "&udatilde;":"&lsaquo;udatilde&rsaquo;",
    "&udh;":"&#613;",
    "&udotab;":"&lsaquo;udotab&rsaquo;",
    "&udpsi;":"&lsaquo;udpsi&rsaquo;",
    "&udqm;":"&iquest;",
    "&udT;":"&lsaquo;udT&rsaquo;",
    "&udtr;":"&nabla;",
    "&udw;":"&#653;",
    "&ufrbl;":"&lsaquo;ufrbl&rsaquo;",
    "&ufrown;":"&#535;",
    "&ugrave;":"&ugrave;",
    "&uhacek;":"&#468;",
    "&uhook;":"&#371;",
    "&ulenis;":"&#8016;",
    "&ulenisacu;":"&#8020;",
    "&Ulenisacu;":"&lsaquo;Ulenisacu&rsaquo;",
    "&ulenisfrown;":"&#8022;",
    "&Ulenis;":"&lsaquo;Ulenis&rsaquo;",
    "&Umac;":"&#362;",
    "&umac;":"&#363;",
    "&umacacu;":"&lsaquo;umacacu&rsaquo;",
    "&umacbreve;":"&lsaquo;umacbreve&rsaquo;",
    "&uncU;":"&lsaquo;uncU&rsaquo;",
    "&union;":"&cup;",
    "&upsilon;":"&upsilon;",
    "&Upsilon;":"&Upsilon;",
    "&utilde;":"&#361;",
    "&utildeacu;":"&#7801;",
    "&uumlacu;":"&#472;",
    "&uumlcirc;":"&lsaquo;uumlcirc&rsaquo;",
    "&uumlgrave;":"&#476;",
    "&uumlhacek;":"&#474;",
    "&uumlmac;":"&#470;",
    "&uuml;":"&uuml;",
    "&Uuml;":"&Uuml;",
    "&vavpath;":"&lsaquo;vavpath&rsaquo;",
    "&vavsheva;":"&lsaquo;vavsheva&rsaquo;",
    "&vb;":"|",
    "&vddd;":"&#8942;",
    "&vdftheta;":"&theta;",
    "&versicle1;":"&#8483;",
    "&versicle2;":"&lsaquo;versicle2&rsaquo;",
    "&vinc;":"&lsaquo;vinc&rsaquo;",
    "&virgo;":"&#9805;",
    "&vpal;":"&#607;",
    "&vuml;":"&lsaquo;vuml&rsaquo;",
    "&vvf;":"&#611;",
    "&wacu;":"&#7811;",
    "&wapos;":"&lsaquo;wapos&rsaquo;",
    "&wasper;":"&#8033;",
    "&Wasper;":"&#8041;",
    "&wasperacu;":"&#8037;",
    "&wasperfrown;":"&#8039;",
    "&Wasperfrown;":"&#8047;",
    "&wavyeq;":"&asymp;",
    "&wcirc;":"&#373;",
    "&wdotbl;":"&#7817;",
    "&wgrave;":"&#7809;",
    "&whacek;":"&lsaquo;whacek&rsaquo;",
    "&wisub;":"&#8179;",
    "&wisubacu;":"&#8180;",
    "&wisubfrown;":"&#8183;",
    "&wlenis;":"&#8032;",
    "&Wlenis;":"&#8040;",
    "&wlenisacu;":"&#8036;",
    "&Wlenisacu;":"&#8044;",
    "&wlenisfrown;":"&#8038;",
    "&wlenisisub;":"&#8096;",
    "&wmac;":"&lsaquo;wmac&rsaquo;",
    "&woqab;":"&lsaquo;woqab&rsaquo;",
    "&wyn;":"&#447;",
    "&Wyn;":"&#503;",
    "&xdotab;":"&#7819;",
    "&xi;":"&xi;",
    "&Xi;":"&Xi;",
    "&yacu;":"&yacute;",
    "&ybreve;":"&lsaquo;ybreve&rsaquo;",
    "&ycirc;":"&#375;",
    "&Ydotab;":"&#7822;",
    "&ydotab;":"&#7823;",
    "&ye;":"&lsaquo;ye&rsaquo;",
    "&Ygh;":"&#540;",
    "&ygh;":"&#541;",
    "&ygrave;":"&#7923;",
    "&ymacacu;":"&lsaquo;ymacacu&rsaquo;",
    "&ymacbreve;":"&lsaquo;ymacbreve&rsaquo;",
    "&ymac;":"&lsaquo;ymac&rsaquo;",
    "&ytilde;":"&#7929;",
    "&yt;":"&lsaquo;yt&rsaquo;",
    "&yuml;":"&yuml;",
    "&Yundl;":"&lsaquo;Yundl&rsaquo;",
    "&zacu;":"&#378;",
    "&zbreve;":"&lsaquo;zbreve&rsaquo;",
    "&zced;":"&lsaquo;zced&rsaquo;",
    "&zdotab;":"&#380;",
    "&zdotbl;":"&#7827;",
    "&zeta;":"&zeta;",
    "&Zeta;":"&Zeta;",
    "&zh;":"&#658;",
    "&zhacekdotab;":"&lsaquo;zhacekdotab&rsaquo;",
    "&zhacek;":"ž",
    "&Zhacek;":"Ž",
    "&zhhacekdotab;":"&lsaquo;zhhacekdotab&rsaquo;",
    "&zmac;":"&lsaquo;zmac&rsaquo;"
}
start_strings = oneOf("q w qt d i s def qp x xr a anum num pnum sc hw ps sg kg hg e bf b lg dg il ph bl pqp pg hm tf shw spg gk r su n in et upd hl sube cs ss ov co bcu bco cu susc bu textformat insc scs bscu nu dn bsco bo xcn")
charset = oneOf(list("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789][%!?+*_#:-)(='\",.&;/<> "))

class Parse(object):
    def __init__(self, use_utf8=False):
        self.use_utf8 = use_utf8
        if use_utf8:
            self.entity_table = {t[0]:html.unescape(t[1]) for t in entity_table.items()}
        else:
            self.entity_table = entity_table

        # Set up parser
        L = Literal
        start = (L("<").suppress()                                                             \
                 + start_strings                                                         \
                 + Optional( White().suppress() + Combine(OneOrMore(~L(">") + charset))).suppress() \
                 + L(">").suppress()) # Assumes no escaped '>'
        end = (L("</")                                                                         \
               + start_strings                                                          \
               + Optional( White() + Combine(OneOrMore(~L(">") + charset))) \
               + L(">")).suppress()
        entity = Regex("<br>|&.*?;").setParseAction( lambda toks: self.entity_table[toks[0]])
        string = Combine(OneOrMore( Combine(OneOrMore( ~(end | start | entity) + charset)) | entity))

        block = Forward()
        block << Group(start + Optional(OneOrMore( block | string )) + end)
        self.dictionary = OneOrMore( L("#").suppress() | block) + LineEnd()

    def parseString(self, buf):
        return self.dictionary.parseString(buf)

    def parseToJSON(self, buf):
        parsedata = self.dictionary.parseString(buf)
        parsedata = [Parse._make_dict(x) for x in parsedata.asList()]
        if self.use_utf8:
            return bytes(json.dumps(parsedata, indent='\t'), "utf-8").decode('unicode-escape')
        else:
            return json.dumps(parsedata, indent='\t')

    @staticmethod
    def _collapse_list(l):
        '''If a list conains only dictionaries and those dictionaries
           can be combined preserving uniqueness, do so.'''
        ret = {}
        for e in l:
            if not (type(e) is dict):
                return l
            for k,x in e.items():
                if not (k in ret):
                    ret[k] = x
                else:
                    return l
        return ret
    @staticmethod
    def _make_dict(results):
        '''.toDict() is broken so convert the output from .toList()'''
        if type(results[0]) == str:
            l = []
            for x in results[1:]:
                if len(x) == 0:
                    continue
                if type(x) is str:
                    l += [x]
                else:
                    d = Parse._make_dict(x)
                    l += [d]
            if len(l) == 1:
                l = l[0]
            return {results[0] : Parse._collapse_list(l)}
        else:
            l = [Parse._make_dict(x) for x in results]
            # if len(l) == 1:
                # l = l[0]
            return Parse._collapse_list(l)

def main():
    parser_test()

def parser_test():
    dictionary = Parse()
    print(dictionary.parseString("#<e>hg text = \"test\"></e>"))
    print(dictionary.parseString("#<e><kg><hg></hg></kg></e>"))
    print(dictionary.parseString("#<e><kg><hg d></hg></kg></e>"))
    print(dictionary.parseString("#<e><kg><hg text=\"new\"></hg></kg></e>"))
    print(dictionary.parseString("#<e><br><br>&aeacu;<kg><hg text=\"new\"></hg></kg></e>"))
    print(dictionary.parseString("#<e>a&nb;kjdf<br><br>&aeacu;<kg><hg text=\"new\"></hg><br><br></kg></e>"))

if __name__ == "__main__":
    main()
